<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–£—á—ë—Ç –ø–∏—Ç–∞–Ω–∏—è</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      text-align: center;
      padding: 40px;
    }
    input, button {
      font-size: 16px;
      padding: 10px;
      margin: 10px;
      width: 200px;
    }
    #result {
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>üìã –£—á—ë—Ç –ø–∏—Ç–∞–Ω–∏—è</h1>

  <input type="text" id="firstName" placeholder="–ò–º—è" required><br>
  <input type="text" id="lastName" placeholder="–§–∞–º–∏–ª–∏—è" required><br>
  <input type="text" id="personnelNumber" placeholder="–¢–∞–±. –Ω–æ–º–µ—Ä (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"><br>
  <input type="text" id="company" placeholder="–ö–æ–º–ø–∞–Ω–∏—è" required><br>

  <button onclick="sendData()">–Ø –ø—Ä–∏—à—ë–ª</button>
  <div id="result"></div>

  <script>
    async function sendData() {
      const data = {
        firstName: document.getElementById("firstName").value.trim(),
        lastName: document.getElementById("lastName").value.trim(),
        personnelNumber: document.getElementById("personnelNumber").value.trim(),
        company: document.getElementById("company").value.trim()
      };

      const resultBox = document.getElementById("result");
      resultBox.textContent = "‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞...";

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbxRTZzPdyHvFyTMlUcn1vY7Ye-Xriv5iWUeSY8oX-B-QRWp-NgriakXRodkqTjMKpYB/exec", {
          method: "POST",
          mode: "no-cors", // –í—Ä–µ–º–µ–Ω–Ω–æ, –µ—Å–ª–∏ –±—É–¥–µ—Ç CORS –æ—à–∏–±–∫–∞ ‚Äî –ø–æ–º–µ–Ω—è–µ–º
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        // –ü–æ—Å–∫–æ–ª—å–∫—É no-cors, –º—ã –Ω–µ –ø–æ–ª—É—á–∏–º –æ—Ç–≤–µ—Ç ‚Äî –≤—ã–≤–æ–¥–∏–º –ø—Ä–æ—Å—Ç–æ "–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ"
        resultBox.textContent = "‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã";
      } catch (error) {
        console.error(error);
        resultBox.textContent = "‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö";
      }
    }
  </script>
</body>
</html>
